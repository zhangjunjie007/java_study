## 项目技能点以及使用场景：
## 有哪些模块：
### 公共模块：

- 系统模块
- 工作流模块
- 在线文档
- 日志模块
### 业务模块：

- 需求模块
- 测试模块
- 投产模块
- 问题补丁模块
## Redis使用

- 单点登录，存取用户的session  （多个服务之间，新老服务之间）
- 。。。
## Kafka（最后改为rabbitmq，可以查看一下kafka的使用场景，这里不合适）

- **埋点统计**：

                    1. 点击菜单时，或者功能按钮时。记录用户行为（哪些功能，哪些用户，操作了什么功能）

                    2. 发送行为消息到 Kafka ，接受消息 保存到数据库日志记录表（采用了`分表`技术）

                    3. 管理部定期从表中拉取数据分析

- **发送邮件通知**
1. 例如需求项确认时，发送通知到到Kafka，调用邮件发送接口给对应角色发送邮件
## 分表
### 系统分表使用场景：
> 1.  埋点记录日志：批量定期新增日志表。插入的时候`表名+日期`实现动态新增表 
> 2.  用户已办日志： 
>    - 初始化固定数量的表
>    - 用户id对表的数量取余
>    - 表名+余数 就是用户要插入的表
> 3.  操作日志：根据业务（eg:需求移交、立项等）区分。进行记录（单表） 

### **分表以后的查询**

- 单表直接查
- 多表可以用union all 关联查询，或者建立视图查询（视图可以统一过滤条件，例如两个日期之间）
## Dubbo

#### 注册中心：
              zookeeper
## 数据库
### 分库
    需求业务和测试相关的业务分别存在不同的库。
### 遇到的问题
#### in后面的参数超过一千报错
       java.sql.SQLException: ORA-01795: 列表中的最大表达式数为 1000
##### 解决方案
1、返回的集合拆分多个list，每个小于1000。 再用OR拼接
#### 多个表关联查询，有索引但是没走。
##### 解决方案
1、两个表的编码不一样。一个是utf8（3字节）  一个是utf8mb4（4字节）

---

#### 跨库查询表数据：
>  eg：在需求平台要把测试平台数据拉过来


##### 解决方案

1、把别的库的数据放在别的服务，连接别的库。再调用他们的接口获取数据

2、使用ETL工具做跨库的表同步，一般来说数据库的实时性要求不太高。

3、通过服务查询后的数据集，通过代码进行二次封装，将此种需要经常调用的数据缓存到分布式缓存中，减小查询压力

4、合理的字段冗余是润滑剂，减少join关联查询（建议控制在2-4个	）

## 多线程使用
> 使用场景:
>         **需求项导出**,**用例入库**


### 需求项导出
>      多线程主要用来处理查询缓慢的问题：


       1、先根据查询条件，查出总的数据量

       2、每个线程按500条数据分页处理，一个线程查询一页

       3、利用 `countDownLatch`归并处理

       4、利用Poi把查出来的数据导出
### 用例入库 
>    异步查询。提升效率

   1. 用例入库需要关联其他表信息，拼接成一个大json，来源于好多表
   2. 利用多线程，查询其他表信息
   3. 利用 `countDownLatch`归并处理
